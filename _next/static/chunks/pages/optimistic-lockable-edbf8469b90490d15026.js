(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[392],{7315:function(e,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.History=void 0;var t=function(){function e(e,a){this.onChange=a,this.presenceHistoryEntry={state:Object.freeze(e),timeStep:function(){throw"beginning time step can't be executed"},stable:!0,futureHistoryEntry:void 0,pastHistoryEntry:void 0}}return Object.defineProperty(e.prototype,"presence",{get:function(){return this.presenceHistoryEntry.state},enumerable:!1,configurable:!0}),e.prototype.pNext=function(e,a){var t=this.presenceHistoryEntry,n=!a||null!=t.pastHistoryEntry,s={state:Object.freeze(e(t.state)),timeStep:e,futureHistoryEntry:void 0,pastHistoryEntry:n?t:void 0,stable:a};return t.futureHistoryEntry=s,this.presenceHistoryEntry=s,this.onChange(this.presenceHistoryEntry.state),s},e.prototype.next=function(e){this.pNext(e,!0)},e.prototype.maybeNext=function(e){var a=this,t=this.pNext(e,!1);return function(e){if(null==t.pastHistoryEntry)throw"future history event's past entry can't be empty";e?t.stable=!0:(t.pastHistoryEntry.futureHistoryEntry=t.futureHistoryEntry,null!=t.futureHistoryEntry&&(t.futureHistoryEntry.pastHistoryEntry=t.pastHistoryEntry));for(var n=t.pastHistoryEntry;null!=n.futureHistoryEntry;)null==n.pastHistoryEntry&&n.futureHistoryEntry.stable&&(n.futureHistoryEntry.pastHistoryEntry=void 0),n.futureHistoryEntry.state=Object.freeze(n.futureHistoryEntry.timeStep(n.state)),n=n.futureHistoryEntry;e||(a.presenceHistoryEntry=n,a.onChange(a.presenceHistoryEntry.state))}},e.prototype.logStableChain=function(){for(var e=this.presenceHistoryEntry,a=e.stable+"";null!=e.pastHistoryEntry;)a=(e=e.pastHistoryEntry).stable+"->"+a;console.log(a)},e}();a.History=t},8348:function(e,a,t){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,a,t,n){void 0===n&&(n=t),Object.defineProperty(e,n,{enumerable:!0,get:function(){return a[t]}})}:function(e,a,t,n){void 0===n&&(n=t),e[n]=a[t]}),s=this&&this.__exportStar||function(e,a){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(a,t)||n(a,e,t)};Object.defineProperty(a,"__esModule",{value:!0}),s(t(7315),a)},4871:function(e,a,t){"use strict";t.r(a),t.d(a,{OptimisticLockableExamplePage:function(){return R},default:function(){return Z}});var n=t(8077),s=t(7378),o=t(4671),c=t(1655),p=t(7982),r=t(5671),m=t(3144),k=t(7326),N=t(9340),u=t(6215),l=t(1120),i=t(4942),d=t(3349),y=t(8348),f=t(6974),w=t(697),b=t(9148);function h(e){var a=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=(0,l.Z)(e);if(a){var s=(0,l.Z)(this).constructor;t=Reflect.construct(n,arguments,s)}else t=n.apply(this,arguments);return(0,u.Z)(this,t)}}var v=function(e){(0,N.Z)(t,e);var a=h(t);function t(e,n){var s;return(0,r.Z)(this,t),s=a.call(this),(0,i.Z)((0,k.Z)(s),"state",void 0),(0,i.Z)((0,k.Z)(s),"history",void 0),(0,i.Z)((0,k.Z)(s),"subscriber",d.Subscriber.create(t,(function(e,a,t){var n=s.state.getState();a(n.value,n.owner)}))),(0,i.Z)((0,k.Z)(s),"setSliderLock",d.Request.create((0,k.Z)(s),"setSliderLock",(function(e,a){if(null!=e)return Math.random()>.5?(s.history.next((function(e){var t=e.value;return{owner:a,value:t}})),s.forceSliderLock.publishTo({to:"all-except-one",except:e},a),(0,f.of)(!0)):(0,f.of)(!1);var t=s.history.maybeNext((function(e){var t=e.value;return{owner:a,value:t}}));return s.setSliderLock.publishTo(s.links[0],a).pipe((0,w.b)((function(e){return t(e)})))}))),(0,i.Z)((0,k.Z)(s),"forceSliderLock",d.Action.create((0,k.Z)(s),"forceSliderLock",(function(e,a){s.history.next((function(e){var t=e.value;return{owner:a,value:t}}))}))),(0,i.Z)((0,k.Z)(s),"setSlider",d.Action.create((0,k.Z)(s),"setSlider",(function(e,a,t){s.history.next((function(e){return e.owner!=a?e:{owner:e.owner,value:t}})),s.history.presence.owner==a&&s.setSlider.publishTo(null==e?{to:"all"}:{to:"all-except-one",except:e},a,t)}))),s.state=(0,b.Z)((function(){return{value:e,owner:n}})),s.history=new y.History(s.state.getState(),(function(e){return s.state.setState(e)})),s}return(0,m.Z)(t,[{key:"onUnlink",value:function(e){}},{key:"onLink",value:function(e){}}]),t}(d.Store),S=t(7462),g=t(4925),x=t(3905),E=["components"],H={};function L(e){var a=e.components,t=(0,g.Z)(e,E);return(0,x.kt)("wrapper",(0,S.Z)({},H,t,{components:a,mdxType:"MDXLayout"}),(0,x.kt)("h1",null,"Optimistic Lockable Example"),(0,x.kt)("p",null,"A variant of the Lockable.",(0,x.kt)("br",{parentName:"p"}),"\n","To achieve a better experience for the clients, it is beneficial to assume things like locks are granted before the server responds to get a more fluid user experience!",(0,x.kt)("br",{parentName:"p"}),"\n","The Optimistic Lockable shows exactly that capability."),(0,x.kt)("p",null,"Let's see how it works ..."),(0,x.kt)("pre",{className:"language-typescript"},(0,x.kt)("code",{parentName:"pre",className:"language-typescript"},(0,x.kt)("span",{parentName:"code",className:"token keyword module"},"export")," ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"class")," ",(0,x.kt)("span",{parentName:"code",className:"token class-name"},(0,x.kt)("span",{parentName:"span",className:"token maybe-class-name"},"OptimisticLockableStore"))," ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"extends")," ",(0,x.kt)("span",{parentName:"code",className:"token class-name"},(0,x.kt)("span",{parentName:"span",className:"token maybe-class-name"},"Store"))," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"public")," state",(0,x.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,x.kt)("span",{parentName:"code",className:"token maybe-class-name"},"StoreApi"),(0,x.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{")," value",(0,x.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,x.kt)("span",{parentName:"code",className:"token builtin"},"number"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},";")," owner",(0,x.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,x.kt)("span",{parentName:"code",className:"token builtin"},"string")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,x.kt)("span",{parentName:"code",className:"token operator"},">"),"\n    ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"private")," history",(0,x.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,x.kt)("span",{parentName:"code",className:"token maybe-class-name"},"History"),(0,x.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{")," value",(0,x.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,x.kt)("span",{parentName:"code",className:"token builtin"},"number"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},";")," owner",(0,x.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,x.kt)("span",{parentName:"code",className:"token builtin"},"string")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,x.kt)("span",{parentName:"code",className:"token operator"},">"),"\n\n    ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"public")," ",(0,x.kt)("span",{parentName:"code",className:"token function"},"onUnlink"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),"link",(0,x.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,x.kt)("span",{parentName:"code",className:"token maybe-class-name"},"StoreLink"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,x.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"void")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n    ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"public")," ",(0,x.kt)("span",{parentName:"code",className:"token function"},"onLink"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),"link",(0,x.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,x.kt)("span",{parentName:"code",className:"token maybe-class-name"},"StoreLink"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,x.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"void")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n    ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"public")," subscriber",(0,x.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,x.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Subscriber")," ",(0,x.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,x.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Subscriber"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token method function property-access"},"create"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token maybe-class-name"},"OptimisticLockableStore"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),"connection",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," accept",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," deny",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,x.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"const")," s ",(0,x.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token property-access"},"state"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token method function property-access"},"getState"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,x.kt)("span",{parentName:"code",className:"token function"},"accept"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),"s",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token property-access"},"value"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," s",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token property-access"},"owner"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,x.kt)("span",{parentName:"code",className:"token function"},"constructor"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),"value",(0,x.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,x.kt)("span",{parentName:"code",className:"token builtin"},"number"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," owner",(0,x.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,x.kt)("span",{parentName:"code",className:"token builtin"},"string"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"super"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token property-access"},"state")," ",(0,x.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,x.kt)("span",{parentName:"code",className:"token function"},"create"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,x.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{")," value",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," owner ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token property-access"},"history")," ",(0,x.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"new")," ",(0,x.kt)("span",{parentName:"code",className:"token class-name"},(0,x.kt)("span",{parentName:"span",className:"token maybe-class-name"},"History")),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token property-access"},"state"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token method function property-access"},"getState"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),"presence",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,x.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token property-access"},"state"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token method function property-access"},"setState"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),"presence",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n    setSliderLock",(0,x.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,x.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Request"),(0,x.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"["),(0,x.kt)("span",{parentName:"code",className:"token builtin"},"string"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"]"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,x.kt)("span",{parentName:"code",className:"token builtin"},"boolean"),(0,x.kt)("span",{parentName:"code",className:"token operator"},">")," ",(0,x.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,x.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Request"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token method function property-access"},"create"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,x.kt)("span",{parentName:"code",className:"token string"},'"setSliderLock"'),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),"origin",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," owner",(0,x.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,x.kt)("span",{parentName:"code",className:"token builtin"},"string"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,x.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,x.kt)("span",{parentName:"code",className:"token keyword control-flow"},"if")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),"origin ",(0,x.kt)("span",{parentName:"code",className:"token operator"},"!=")," ",(0,x.kt)("span",{parentName:"code",className:"token keyword null nil"},"null"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ",(0,x.kt)("span",{parentName:"code",className:"token keyword control-flow"},"if")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token known-class-name class-name"},"Math"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token method function property-access"},"random"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,x.kt)("span",{parentName:"code",className:"token operator"},">")," ",(0,x.kt)("span",{parentName:"code",className:"token number"},"0.5"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token property-access"},"history"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token method function property-access"},"next"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{")," value ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,x.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                    owner",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n                    value",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n                ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n                ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token property-access"},"forceSliderLock"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token method function property-access"},"publishTo"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{")," to",(0,x.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,x.kt)("span",{parentName:"code",className:"token string"},'"all-except-one"'),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," except",(0,x.kt)("span",{parentName:"code",className:"token operator"},":")," origin ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," owner",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n                ",(0,x.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return")," ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"of"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token boolean"},"true"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n            ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n            ",(0,x.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return")," ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"of"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token boolean"},"false"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,x.kt)("span",{parentName:"code",className:"token keyword control-flow"},"else")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"const")," resolve ",(0,x.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token property-access"},"history"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token method function property-access"},"maybeNext"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{")," value ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,x.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{")," owner",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," value ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n            ",(0,x.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return")," ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token property-access"},"setSliderLock"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token method function property-access"},"publishTo"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token property-access"},"links"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"["),(0,x.kt)("span",{parentName:"code",className:"token number"},"0"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"]"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," owner",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token method function property-access"},"pipe"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token function"},"tap"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),"keep",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,x.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,x.kt)("span",{parentName:"code",className:"token function"},"resolve"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),"keep",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n    ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"private")," forceSliderLock ",(0,x.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,x.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Action"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token method function property-access"},"create"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,x.kt)("span",{parentName:"code",className:"token string"},'"forceSliderLock"'),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),"origin",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," owner",(0,x.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,x.kt)("span",{parentName:"code",className:"token builtin"},"string"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,x.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token property-access"},"history"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token method function property-access"},"next"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{")," value ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,x.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            owner",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n            value",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    setSlider ",(0,x.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,x.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Action"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token method function property-access"},"create"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,x.kt)("span",{parentName:"code",className:"token string"},'"setSlider"'),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),"origin",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," by",(0,x.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,x.kt)("span",{parentName:"code",className:"token builtin"},"string"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," value",(0,x.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,x.kt)("span",{parentName:"code",className:"token builtin"},"number"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,x.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token property-access"},"history"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token method function property-access"},"next"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),"state",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,x.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ",(0,x.kt)("span",{parentName:"code",className:"token keyword control-flow"},"if")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),"state",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token property-access"},"owner")," ",(0,x.kt)("span",{parentName:"code",className:"token operator"},"!=")," by",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                ",(0,x.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return")," state\n            ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n            ",(0,x.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                owner",(0,x.kt)("span",{parentName:"code",className:"token operator"},":")," state",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token property-access"},"owner"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n                value",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n            ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n        ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n        ",(0,x.kt)("span",{parentName:"code",className:"token keyword control-flow"},"if")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token property-access"},"history"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token property-access"},"presence"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token property-access"},"owner")," ",(0,x.kt)("span",{parentName:"code",className:"token operator"},"!=")," by",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ",(0,x.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return"),"\n        ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n        ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token property-access"},"setSlider"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token method function property-access"},"publishTo"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),"origin ",(0,x.kt)("span",{parentName:"code",className:"token operator"},"==")," ",(0,x.kt)("span",{parentName:"code",className:"token keyword null nil"},"null")," ",(0,x.kt)("span",{parentName:"code",className:"token operator"},"?")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{")," to",(0,x.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,x.kt)("span",{parentName:"code",className:"token string"},'"all"')," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,x.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{")," to",(0,x.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,x.kt)("span",{parentName:"code",className:"token string"},'"all-except-one"'),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," except",(0,x.kt)("span",{parentName:"code",className:"token operator"},":")," origin ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," by",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," value",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n")),(0,x.kt)("pre",{className:"language-typescript"},(0,x.kt)("code",{parentName:"pre",className:"language-typescript"},(0,x.kt)("span",{parentName:"code",className:"token keyword module"},"export")," ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"function")," ",(0,x.kt)("span",{parentName:"code",className:"token function"},(0,x.kt)("span",{parentName:"span",className:"token maybe-class-name"},"OptimisticLockableExamplePage")),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{")," rootStore ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,x.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{")," rootStore",(0,x.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,x.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Store")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"const")," store ",(0,x.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,x.kt)("span",{parentName:"code",className:"token function"},"useChildStore"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),"rootStore",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," rootStore",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token property-access"},"links"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"["),(0,x.kt)("span",{parentName:"code",className:"token number"},"0"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"]"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,x.kt)("span",{parentName:"code",className:"token maybe-class-name"},"OptimisticLockableStore"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,x.kt)("span",{parentName:"code",className:"token number"},"1000"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,x.kt)("span",{parentName:"code",className:"token string"},'"optimistic-lockable"'),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"const")," id ",(0,x.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,x.kt)("span",{parentName:"code",className:"token function"},"useMemo"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,x.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," rootStore",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token property-access"},"links"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"["),(0,x.kt)("span",{parentName:"code",className:"token number"},"0"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"]"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token property-access"},"connection"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token property-access"},"userData"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token property-access"},"id"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"["),"rootStore",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"]"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"const")," inputRef ",(0,x.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,x.kt)("span",{parentName:"code",className:"token generic-function"},(0,x.kt)("span",{parentName:"span",className:"token function"},"useRef"),(0,x.kt)("span",{parentName:"span",className:"token generic class-name"},(0,x.kt)("span",{parentName:"span",className:"token operator"},"<"),(0,x.kt)("span",{parentName:"span",className:"token maybe-class-name"},"HTMLInputElement"),(0,x.kt)("span",{parentName:"span",className:"token operator"},">"))),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token keyword null nil"},"null"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"const")," useStoreState ",(0,x.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,x.kt)("span",{parentName:"code",className:"token function"},"useMemo"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,x.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,x.kt)("span",{parentName:"code",className:"token function"},"create"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),"store",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token property-access"},"state"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"["),"store",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"]"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,x.kt)("span",{parentName:"code",className:"token keyword"},"const")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{")," owner",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," value ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,x.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,x.kt)("span",{parentName:"code",className:"token function"},"useStoreState"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,x.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n        ",(0,x.kt)("span",{parentName:"code",className:"token operator"},"<"),"div",(0,x.kt)("span",{parentName:"code",className:"token operator"},">"),"\n            ",(0,x.kt)("span",{parentName:"code",className:"token operator"},"<"),"button className",(0,x.kt)("span",{parentName:"code",className:"token operator"},"="),(0,x.kt)("span",{parentName:"code",className:"token string"},'"btn btn-outline-primary"')," onClick",(0,x.kt)("span",{parentName:"code",className:"token operator"},"="),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,x.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," store",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token method function property-access"},"setSliderLock"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token string"},'"none"'),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token method function property-access"},"subscribe"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,x.kt)("span",{parentName:"code",className:"token operator"},">"),"\n                release\n            ",(0,x.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,x.kt)("span",{parentName:"code",className:"token operator"},"/"),"button",(0,x.kt)("span",{parentName:"code",className:"token operator"},">"),"\n            ",(0,x.kt)("span",{parentName:"code",className:"token operator"},"<"),"h2",(0,x.kt)("span",{parentName:"code",className:"token operator"},">"),(0,x.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Owner"),(0,x.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"owner",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,x.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,x.kt)("span",{parentName:"code",className:"token operator"},"/"),"h2",(0,x.kt)("span",{parentName:"code",className:"token operator"},">"),"\n            ",(0,x.kt)("span",{parentName:"code",className:"token operator"},"<"),"input\n                onChange",(0,x.kt)("span",{parentName:"code",className:"token operator"},"="),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,x.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                    ",(0,x.kt)("span",{parentName:"code",className:"token keyword control-flow"},"if")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),"inputRef",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token property-access"},"current"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                        ",(0,x.kt)("span",{parentName:"code",className:"token keyword control-flow"},"if")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),"owner ",(0,x.kt)("span",{parentName:"code",className:"token operator"},"!==")," id",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                            store",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token method function property-access"},"setSliderLock"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),"id",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token method function property-access"},"subscribe"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n                        ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n                        store",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token method function property-access"},"setSlider"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"("),"id",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},",")," inputRef",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token property-access"},"current"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,x.kt)("span",{parentName:"code",className:"token property-access"},"valueAsNumber"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n                    ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n                ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n                className",(0,x.kt)("span",{parentName:"code",className:"token operator"},"="),(0,x.kt)("span",{parentName:"code",className:"token string"},'"w-100"'),"\n                type",(0,x.kt)("span",{parentName:"code",className:"token operator"},"="),(0,x.kt)("span",{parentName:"code",className:"token string"},'"range"'),"\n                min",(0,x.kt)("span",{parentName:"code",className:"token operator"},"="),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{"),(0,x.kt)("span",{parentName:"code",className:"token number"},"0"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n                max",(0,x.kt)("span",{parentName:"code",className:"token operator"},"="),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{"),(0,x.kt)("span",{parentName:"code",className:"token number"},"10"),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n                value",(0,x.kt)("span",{parentName:"code",className:"token operator"},"="),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"value",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n                ref",(0,x.kt)("span",{parentName:"code",className:"token operator"},"="),(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"inputRef",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,x.kt)("span",{parentName:"code",className:"token operator"},">"),(0,x.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,x.kt)("span",{parentName:"code",className:"token operator"},"/"),"input",(0,x.kt)("span",{parentName:"code",className:"token operator"},">"),"\n        ",(0,x.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,x.kt)("span",{parentName:"code",className:"token operator"},"/"),"div",(0,x.kt)("span",{parentName:"code",className:"token operator"},">"),"\n    ",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n",(0,x.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n")))}L.isMDXComponent=!0;var j=t(9138),O=t(4246);function Z(){return(0,O.jsxs)("div",{className:"d-flex flex-column fullscreen",children:[(0,O.jsx)(c.h,{selectedIndex:5}),(0,O.jsxs)("div",{className:"d-flex flex-column justify-content-stretch container-lg",children:[(0,O.jsx)("div",{className:"d-flex flex-row-responsive",children:(0,O.jsx)(p.X,{twoClients:!0,initStore:function(e){return e.addChildStore(new v(0,"none"),!1,"optimistic-lockable")},children:function(e){return(0,O.jsx)(R,{rootStore:e})}})}),(0,O.jsx)("div",{className:"p-3 flex-basis-0 flex-grow-1",children:(0,O.jsx)(L,{})})]}),(0,O.jsx)(j.$,{})]})}function R(e){var a=e.rootStore,t=(0,n.useChildStore)(a,a.links[0],v,1e3,"optimistic-lockable"),c=(0,s.useMemo)((function(){return a.links[0].connection.userData.id}),[a]),p=(0,s.useRef)(null),r=(0,s.useMemo)((function(){return(0,o.Z)(t.state)}),[t])(),m=r.owner,k=r.value;return(0,O.jsxs)("div",{className:"p-3",children:[(0,O.jsx)("button",{className:"btn btn-outline-primary",onClick:function(){return t.setSliderLock("none").subscribe()},children:"release"}),(0,O.jsxs)("h2",{children:["Owner: ",m]}),(0,O.jsx)("input",{onChange:function(){p.current&&(m!==c&&t.setSliderLock(c).subscribe(),t.setSlider(c,p.current.valueAsNumber))},className:"w-100",type:"range",min:0,max:10,value:k,ref:p})]})}},8616:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/optimistic-lockable",function(){return t(4871)}])},4671:function(e,a,t){"use strict";var n=t(7378);function s(e){let a;const t=new Set,n=(e,n)=>{const s="function"===typeof e?e(a):e;if(s!==a){const e=a;a=n?s:Object.assign({},a,s),t.forEach((t=>t(a,e)))}},s=()=>a,o={setState:n,getState:s,subscribe:(e,n,o)=>n||o?((e,n=s,o=Object.is)=>{let c=n(a);function p(){const t=n(a);if(!o(c,t)){const a=c;e(c=t,a)}}return t.add(p),()=>t.delete(p)})(e,n,o):(t.add(e),()=>t.delete(e)),destroy:()=>t.clear()};return a=e(n,s,o),o}const o="undefined"===typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?n.useEffect:n.useLayoutEffect;a.Z=function(e){const a="function"===typeof e?s(e):e,t=(e=a.getState,t=Object.is)=>{const[,s]=(0,n.useReducer)((e=>e+1),0),c=a.getState(),p=(0,n.useRef)(c),r=(0,n.useRef)(e),m=(0,n.useRef)(t),k=(0,n.useRef)(!1),N=(0,n.useRef)();let u;void 0===N.current&&(N.current=e(c));let l=!1;(p.current!==c||r.current!==e||m.current!==t||k.current)&&(u=e(c),l=!t(N.current,u)),o((()=>{l&&(N.current=u),p.current=c,r.current=e,m.current=t,k.current=!1}));const i=(0,n.useRef)(c);return o((()=>{const e=()=>{try{const e=a.getState(),t=r.current(e);m.current(N.current,t)||(p.current=e,N.current=t,s())}catch(e){k.current=!0,s()}},t=a.subscribe(e);return a.getState()!==i.current&&e(),t}),[]),l?u:N.current};return Object.assign(t,a),t[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const e=[t,a];return{next(){const a=e.length<=0;return{value:e.shift(),done:a}}}},t}},9148:function(e,a){"use strict";a.Z=function(e){let a;const t=new Set,n=(e,n)=>{const s="function"===typeof e?e(a):e;if(s!==a){const e=a;a=n?s:Object.assign({},a,s),t.forEach((t=>t(a,e)))}},s=()=>a,o={setState:n,getState:s,subscribe:(e,n,o)=>n||o?((e,n=s,o=Object.is)=>{let c=n(a);function p(){const t=n(a);if(!o(c,t)){const a=c;e(c=t,a)}}return t.add(p),()=>t.delete(p)})(e,n,o):(t.add(e),()=>t.delete(e)),destroy:()=>t.clear()};return a=e(n,s,o),o}}},function(e){e.O(0,[667,734,839,774,888,179],(function(){return a=8616,e(e.s=a);var a}));var a=e.O();_N_E=a}]);